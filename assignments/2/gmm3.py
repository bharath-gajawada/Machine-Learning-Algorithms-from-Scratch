# 4.2.3

import numpy as np
import pandas as pd

import sys
sys.path.append("../..")

import models.gmm.gmm as gmm
    
def main():

    df = pd.read_feather('../../data/external/word-embeddings.feather')
    X = np.vstack(df['vit'].values)

    gmm_model = gmm.GMM(n_components=1) # best value is 1 from previous part
    gmm_model.fit(X)
    params = gmm_model.get_params()
    print("Means:\n", params['centers'])
    print("Covariances:\n", params['covariances'])
    print("Weights:\n", params['weights'])
    membership = gmm_model.get_membership()
    print("Memebership:\n", membership)
    likelihood = gmm_model.get_likelihood(X)
    print("Likelihood:\n", likelihood)

if __name__ == "__main__":
    main()

# Means:
#  [[-1.29900086e-02 -5.21759896e-02 -1.90298252e-02  7.76085762e-02
#   -5.49704913e-02 -3.46861647e-02 -1.20059666e-01 -1.08713815e+00
#   -1.75144684e-01  2.18883874e-01  1.43400622e-02 -1.11440015e-01
#   -2.83874472e-02 -1.19346526e-01  1.39063076e-01  8.68718250e-02
#    2.32889712e-01  3.41010491e-02 -1.12773037e-01 -1.30622338e-01
#    2.83807785e-01  8.48280115e-02  8.73114739e-02  1.11429220e-01
#   -1.47840992e-01  8.88185868e-02 -4.71125807e-02  5.40974740e-02
#   -6.55025196e-02  1.83259151e-01 -5.12557255e-02 -6.58600678e-02
#   -5.15292338e-02  8.41206915e-02 -7.68779963e-02  1.40308528e-01
#    3.57167685e-02  8.31628842e-02 -6.58887723e-02 -1.60469263e-02
#   -5.32934688e-02 -7.48123130e-02 -5.09238538e-03 -2.83109102e-02
#    1.34580167e-01  2.60956566e-01  5.26309596e-03  8.77637172e-03
#    1.05035383e-01  1.10248191e-01 -4.11269050e-02 -1.08834606e-01
#    7.51205048e-02 -1.45837847e-01 -1.36777119e-02 -1.56084972e-02
#    1.08749838e-02  1.75899361e-02 -1.83164706e-01  8.27464497e-02
#    2.44594337e-01 -1.54954217e-01  5.17978361e-02 -1.07366926e-01
#   -3.99895338e-02 -1.59756611e-01 -6.07949746e-02  4.25308257e-03
#   -5.49200408e-02 -1.34305344e-01  5.28754469e-02 -1.61575067e-01
#   -4.53653256e-02  1.69286327e-01 -4.57548326e-02 -1.24692325e-01
#    1.29530492e-01  4.97695535e-02 -5.99815236e-02 -1.73811736e-01
#   -1.84327231e-01 -1.74437384e-02 -5.52942256e-02  2.42605686e-01
#   -5.34146476e-02  6.93530260e-03  1.53492495e-02 -2.20275426e-01
#    4.41763293e-02  2.19803591e-02  1.60083396e-02 -6.91110880e-02
#   -1.57187519e+00  3.29612682e-01 -6.31413486e-02  7.70887378e-02
#    1.46644246e-01  1.50010497e-01 -2.14539228e-02 -8.96062872e-02
#    1.38585309e-01  1.04801102e-01  1.80091612e-01 -8.51672481e-02
#   -2.01282548e-01  1.16615245e-03  5.58466051e-02 -7.05075670e-02
#   -9.28317511e-02 -6.28955342e-03 -1.96807574e-03  7.53402419e-02
#   -7.42659501e-02  7.41811526e-03  6.95881227e-03 -1.97574884e-01
#   -1.86489427e-03  2.03493588e-01 -5.66701159e-02  7.56957085e-02
#    1.58298019e-01 -2.77056562e-01 -7.14112793e-02  2.98704219e-02
#    6.70419785e-02 -1.46791684e-01 -1.72315727e-02 -4.45456849e-02
#    1.31612969e-02  3.10850949e-01  1.17083750e-01  1.49178898e-01
#   -1.32650698e-01  6.10783982e+00 -3.04543204e-02 -9.85055911e-03
#   -7.46868922e-02 -3.41662178e-01  2.08399582e-02 -1.17100111e-02
#    1.62691767e-02 -3.68407836e-02 -1.05943612e-01  1.39989741e-01
#   -2.14946688e-01  4.21506410e-02  2.80110311e-02 -3.00993660e-02
#   -7.23513035e-02 -8.83155819e-02  1.09656521e-01 -1.01399245e-01
#   -2.84884366e-02  5.01523423e-02 -2.02198032e-02 -6.86994991e-02
#    2.04696283e-02  6.39483694e-03 -8.80856455e-02  3.98284055e-02
#   -9.41849289e-02 -1.41496411e-02 -1.26851051e-02 -5.03582436e-02
#   -1.66332884e-02  1.63022943e-02  1.82475675e-02 -1.22637574e-01
#    1.49692646e-01  3.22625257e-03  5.07952255e-02  5.07499212e-03
#   -1.14579176e-02  3.69373260e-02 -2.63621479e-01  9.77974148e-02
#   -2.03283622e-01  7.13101087e-02  1.28245266e-01 -3.89390783e-02
#    1.85252857e-01  1.24803565e-01 -6.06770949e-02 -7.22614951e-02
#   -6.11225303e-02 -1.22458398e-01  1.27375576e-01 -1.00971459e-01
#    9.38159457e-02 -6.31358632e-02  5.22514502e-02 -6.98151407e-02
#   -6.35267256e-02  2.38039353e-02 -1.14914689e-01  1.22409965e-01
#   -4.67948115e-02  1.12725102e-01 -1.40563437e-02 -1.19065818e-01
#    1.78622347e-02 -2.37564694e-02  8.69441126e-04  9.56311800e-02
#   -3.19366627e-02  2.38726381e-04 -2.66361196e-02 -1.17813845e-01
#   -7.78896342e-02 -1.80260384e-03  3.73993539e-01  2.66405497e-01
#    4.43831601e-02 -5.44010251e-03  5.51028718e-02  2.14269765e-02
#    3.28895062e-02 -1.56686531e-01 -4.70921906e-02 -1.18717688e-01
#   -6.28972711e-02 -1.48502372e-01 -1.00971205e-01 -1.24672205e-01
#    1.25310079e-01 -1.15445522e-02  8.12783414e-02  6.09792723e-02
#   -2.31323299e-02 -2.36601358e-02  1.31187989e-01  1.13706321e-01
#    6.33622664e-02 -1.27434539e-01  1.03539645e-01  1.74666599e-01
#    4.11138732e-02  3.22900921e-02 -9.55365751e-02 -7.87934660e-02
#    5.25509511e-02  1.04288255e-01  6.49753267e-02 -3.28480217e-02
#   -7.81215286e-02 -4.09956829e-02 -2.08193851e-02 -3.07360866e-02
#    2.84186036e-02 -5.88389662e-02 -1.61463707e-01  1.19725705e-01
#    8.00596868e-02  2.21283995e-01 -7.17006625e-02  1.05451340e-01
#    4.26019993e-02 -7.66230772e-02  3.92452767e-02  1.04887309e-01
#    2.70105196e-02 -1.06934675e-02 -4.34579502e-02 -9.17150965e-02
#    3.87163991e-03 -9.03357201e-02  9.58735270e-02 -1.50384885e-01
#   -8.75982678e-02 -2.18810053e-02 -1.78530823e-02 -9.89812804e-02
#    1.16824080e-01 -4.34805867e-02  2.11471607e-03 -1.23436393e-01
#    4.22008862e-02  3.29846558e-02  3.35996462e-02  9.21433419e-03
#    2.40219016e-01 -1.63284802e-02  9.02581022e-02  6.66049115e-02
#   -4.72296118e-02  9.93175771e-02  2.03541547e-01  1.29305767e-02
#    3.28173279e-02 -6.21538881e-02  1.49668326e-01 -7.83773331e-02
#    7.03231059e-02  1.58887999e-01 -8.30851805e-02 -7.34621131e-02
#   -2.90065925e-01 -1.15529438e-01  2.28007715e-02 -1.53293655e-02
#    3.79312736e-02 -2.44933589e-02 -1.10392866e-01  3.29997270e-02
#   -1.11681672e-02  5.63645322e-02 -6.34676986e-02 -4.67163943e-02
#   -5.76797960e-03  1.05060313e-01 -6.56683673e-04  4.82057296e-02
#    6.10222424e+00  1.02717666e-01 -5.38844726e-02  6.17080588e-02
#    8.36400277e-03  2.47396932e-02  1.36569516e-01  3.15239005e-02
#    2.04305744e-01  4.18693310e-01  1.27877269e-01  4.36664045e-02
#    8.92941160e-03  1.30623222e-02 -2.25787792e-02 -3.85907385e-03
#    6.48606069e-02 -2.22246658e+00  4.33376295e-02  1.35674504e-01
#   -3.21912513e-03  3.70187532e-02  1.05289165e-02 -2.42381654e-02
#    5.88649430e-02 -9.71708633e-03  2.10251471e-02 -9.09151312e-02
#    8.93809445e-03 -6.24668480e-02  6.92211021e-02 -5.84193720e-02
#    6.06650064e-02 -7.51482734e-02  1.01128164e-01  1.54637622e-01
#   -1.84431728e-02 -1.10632090e-03  1.14397608e-01 -1.09120164e-02
#    5.39055176e-03  5.25151049e-02  5.64793710e-03  9.11610533e-02
#   -2.75210538e-02  6.18409794e-02  7.40941774e-02  1.26415708e-01
#   -7.72522635e-03 -3.55562314e-02  9.68743327e-02  1.26033758e-01
#    1.09618445e-01 -2.56231047e-01  6.05602457e-02  1.00582487e-01
#   -4.37562062e-02  2.86045978e-02 -4.45330267e-02 -1.22998138e-02
#   -5.47544786e-02  1.72771863e-01 -1.07079479e-01 -1.35356321e-02
#   -1.27102559e-01  1.55820063e-02 -2.10441836e-01  1.23712363e-02
#   -1.70921918e-01 -1.26108755e-02  4.14351249e-02 -1.22026594e-01
#    7.95171805e-02 -1.13543391e-01 -7.16380978e-03  8.15730421e-02
#   -4.10354317e-02  8.35239370e-03 -2.50620147e-01  4.62526487e-03
#   -9.86198328e-02 -4.16327782e-02  1.91503060e-02  1.75310493e-01
#    1.17719754e-01 -1.00635384e-01 -1.70219512e-01  3.99374655e-01
#    1.36626426e-02  1.45108815e-02  4.63516893e-02 -2.03136790e-02
#   -1.57245308e-01 -4.44754310e-02  1.39115326e-01 -3.78111926e-02
#    9.96121493e-02 -1.15161248e-01  1.09876330e-01  4.12121637e-02
#   -5.77061301e-02  1.95140096e-01  5.94086663e-02  1.11048979e-01
#   -6.21268562e-02 -2.48464155e-02 -1.53713905e-02  9.94346315e-02
#    3.21111314e-02 -6.29534297e-02 -2.17542287e-02 -2.34136596e-01
#   -1.58000062e-02  8.38210730e-02 -1.61542989e-01 -1.43509757e-01
#    1.16381389e-01  1.21589897e-01 -5.10030393e-02 -1.05746271e-01
#   -8.35384733e-02  4.53732713e-02  6.82958562e-02 -6.14938952e-02
#   -9.65133086e-02  4.43581986e-02 -2.20213286e-01  4.43505522e-03
#   -1.01181542e-01 -1.01540303e-01 -4.63651984e-03 -8.68653062e-02
#    1.22354039e-01  1.15051074e-01 -1.48614114e-01 -1.75877508e-01
#    5.43805257e-02  1.32530739e-01 -1.77422163e-02  6.75904831e-02
#    8.17089907e-03  1.15952003e-01  3.45637135e-02  1.52664214e-01
#    1.42905442e-01  8.78779766e-02  6.49779974e-02 -1.71688728e-01
#    1.12236036e-01  8.10061938e-02  6.18991930e-02  9.17891433e-02
#    2.20737646e-01 -1.44132912e-02  7.61921137e-02 -9.33972595e-02
#   -4.21691525e-02 -8.85161077e-02 -1.24316188e-02 -1.80126099e-01
#    8.11866497e-02 -1.86595582e-01  3.78195746e-03  1.27804614e-01
#   -5.29341042e-02  2.35616841e-01  1.07302650e-01  1.23260171e-01
#    1.23074794e-01 -5.74935739e-01  9.95599404e-02 -4.59743694e-02
#    5.64691731e-03 -5.93446679e-02  6.84330019e-02  4.44161784e-02
#    5.56829565e-02 -1.17077765e-01 -2.64942137e-02  6.70780449e-02
#    1.54018866e-03  6.28867478e-01 -8.04055787e-03  3.94933665e-02
#    1.56212793e-01  1.66958144e-03 -1.21878482e-01  1.35104822e-02
#   -5.79449809e-02 -1.08435100e-01  1.51252522e-01  1.35400394e-01
#    1.91447865e-02 -8.64067427e-02  8.52433755e-03 -6.93333779e-02
#   -6.63823007e-02 -2.48983755e-01 -1.11258245e-01  3.13115194e-02]]
# Covariances:
#  [[[ 2.98234736e-02  7.82239280e-05  3.55016624e-03 ... -6.82535628e-03
#     2.67777455e-03 -1.17062036e-03]
#   [ 7.82239280e-05  4.33966894e-02 -2.43116468e-04 ... -8.78883327e-03
#    -4.15580173e-04  3.88595736e-03]
#   [ 3.55016624e-03 -2.43116468e-04  4.50558028e-02 ... -1.13969063e-03
#     1.66209159e-03  3.46288488e-03]
#   ...
#   [-6.82535628e-03 -8.78883327e-03 -1.13969063e-03 ...  5.76890804e-02
#    -1.49421301e-02 -9.74189033e-03]
#   [ 2.67777455e-03 -4.15580173e-04  1.66209159e-03 ... -1.49421301e-02
#     5.28725709e-02  8.54919329e-04]
#   [-1.17062036e-03  3.88595736e-03  3.46288488e-03 ... -9.74189033e-03
#     8.54919329e-04  4.17133432e-02]]]
# Weights:
#  [1.]
# Memebership:
#  [[1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]
#  [1.]]
# Likelihood:
#  1876.2763722093869