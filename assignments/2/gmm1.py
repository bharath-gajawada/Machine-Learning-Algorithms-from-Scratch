# 4.2.1

import numpy as np
import pandas as pd

import sys
sys.path.append("../..")

import models.gmm.gmm as gmm
import sklearn.mixture as skm

def main():

    df = pd.read_feather('../../data/external/word-embeddings.feather')
    X = np.vstack(df['vit'].values)

    gmm_model = gmm.GMM(n_components=3)
    gmm_model.fit(X)
    print("\n======gmm_model======\n")
    params = gmm_model.get_params()
    print("Means:\n", params['centers'])
    print("Covariances:\n", params['covariances'])
    print("Weights:\n", params['weights'])
    membership = gmm_model.get_membership()
    print("Memebership:\n", membership)
    likelihood = gmm_model.get_likelihood(X)
    print("Likelihood:\n", likelihood)

    gmm_sklearn = skm.GaussianMixture(3)
    gmm_sklearn.fit(X)
    print("\n======gmm_sklearn======\n")
    print("Means:\n", gmm_sklearn.means_)
    print("Covariances:\n", gmm_sklearn.covariances_)
    print("Weights:\n", gmm_sklearn.weights_)
    membership = gmm_sklearn.predict_proba(X)
    print("Memebership:\n", membership)
    likelihood = gmm_sklearn.score(X)
    print("Likelihood:\n", likelihood)

if __name__ == "__main__":
    main()

# ======gmm_model======

# Means:
#  [[-0.01284913 -0.06010345  0.01483793 ... -0.1980013  -0.13926284
#    0.01410463]
#  [-0.03180673 -0.071894   -0.07490127 ... -0.25585833 -0.07469909
#    0.03963101]
#  [ 0.00816655 -0.02031596  0.00364984 ... -0.30237152 -0.11908644
#    0.04253104]]
# Covariances:
#  [[[ 0.02601093 -0.0044936   0.00183881 ... -0.0035062   0.00694327
#    -0.00295536]
#   [-0.0044936   0.04200547 -0.00032806 ... -0.00868767  0.00209157
#     0.00870926]
#   [ 0.00183881 -0.00032806  0.03912103 ... -0.00224812  0.00224344
#     0.00176301]
#   ...
#   [-0.0035062  -0.00868767 -0.00224812 ...  0.06860954 -0.01830168
#    -0.0131856 ]
#   [ 0.00694327  0.00209157  0.00224344 ... -0.01830168  0.06152071
#    -0.00263146]
#   [-0.00295536  0.00870926  0.00176301 ... -0.0131856  -0.00263146
#     0.04605074]]

#  [[ 0.03269511  0.00523888 -0.00028108 ... -0.01322073  0.00166739
#     0.00270843]
#   [ 0.00523888  0.05235643  0.00131411 ... -0.00733433  0.00234608
#    -0.00143763]
#   [-0.00028108  0.00131411  0.045546   ... -0.00604852 -0.00158325
#     0.00305242]
#   ...
#   [-0.01322073 -0.00733433 -0.00604852 ...  0.05846186 -0.01749889
#    -0.01292022]
#   [ 0.00166739  0.00234608 -0.00158325 ... -0.01749889  0.04636085
#     0.00964345]
#   [ 0.00270843 -0.00143763  0.00305242 ... -0.01292022  0.00964345
#     0.04382714]]

#  [[ 0.0302951  -0.00137753  0.00826883 ... -0.00258598 -0.00034572
#    -0.00348223]
#   [-0.00137753  0.03338067 -0.003555   ... -0.00852636 -0.00575405
#     0.00379616]
#   [ 0.00826883 -0.003555    0.04619335 ...  0.00445728  0.00827318
#     0.00693959]
#   ...
#   [-0.00258598 -0.00852636  0.00445728 ...  0.03768584 -0.0064328
#    -0.00029083]
#   [-0.00034572 -0.00575405  0.00827318 ... -0.0064328   0.04735758
#    -0.00575688]
#   [-0.00348223  0.00379616  0.00693959 ... -0.00029083 -0.00575688
#     0.03355322]]]
# Weights:
#  [0.36 0.34 0.3 ]
# Memebership:
#  [[0. 1. 0.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [0. 0. 1.]
#  [1. 0. 0.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [0. 1. 0.]
#  [0. 1. 0.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [1. 0. 0.]
#  [0. 0. 1.]
#  [1. 0. 0.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [0. 0. 1.]
#  [0. 0. 1.]
#  [1. 0. 0.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [0. 0. 1.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [0. 1. 0.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [0. 0. 1.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [1. 0. 0.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [0. 0. 1.]
#  [0. 0. 1.]
#  [1. 0. 0.]
#  [0. 0. 1.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [0. 1. 0.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [0. 0. 1.]
#  [1. 0. 0.]
#  [0. 1. 0.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [0. 0. 1.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [0. 1. 0.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [1. 0. 0.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [0. 0. 1.]
#  [1. 0. 0.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [0. 1. 0.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [0. 0. 1.]
#  [1. 0. 0.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [0. 0. 1.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [0. 0. 1.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [1. 0. 0.]
#  [0. 0. 1.]
#  [1. 0. 0.]
#  [0. 0. 1.]
#  [0. 0. 1.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [0. 1. 0.]
#  [0. 1. 0.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [0. 1. 0.]
#  [0. 1. 0.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [0. 1. 0.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [0. 0. 1.]
#  [1. 0. 0.]
#  [0. 0. 1.]
#  [0. 0. 1.]
#  [0. 0. 1.]
#  [0. 0. 1.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [0. 0. 1.]
#  [1. 0. 0.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [1. 0. 0.]
#  [0. 0. 1.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [1. 0. 0.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [0. 0. 1.]
#  [1. 0. 0.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [0. 1. 0.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [0. 1. 0.]
#  [1. 0. 0.]]
# Likelihood:
#  2621.4390212093963

# ======gmm_sklearn======

# Means:
#  [[-0.07585776 -0.07711263 -0.10086962 ... -0.13862606 -0.17444207
#    0.00550791]
#  [ 0.0149295  -0.01850607  0.00364406 ... -0.38344401 -0.07333987
#    0.11241746]
#  [ 0.02661445 -0.05837766  0.04578315 ... -0.2356441  -0.08101443
#   -0.0199692 ]]
# Covariances:
#  [[[ 2.93205575e-02 -2.29962329e-03 -1.69484810e-04 ... -4.52814272e-03
#    -8.59721605e-04 -1.20128951e-04]
#   [-2.29962329e-03  5.10913152e-02 -1.08100213e-02 ... -1.20337628e-03
#    -8.23303920e-03 -9.74868636e-04]
#   [-1.69484810e-04 -1.08100213e-02  4.18189676e-02 ...  5.39671248e-03
#     6.24910711e-03 -5.99939853e-04]
#   ...
#   [-4.52814272e-03 -1.20337628e-03  5.39671248e-03 ...  6.14475232e-02
#    -1.69609563e-02 -1.13577368e-02]
#   [-8.59721605e-04 -8.23303920e-03  6.24910711e-03 ... -1.69609563e-02
#     5.82272270e-02  8.61191078e-03]
#   [-1.20128951e-04 -9.74868636e-04 -5.99939853e-04 ... -1.13577368e-02
#     8.61191078e-03  3.79206657e-02]]

#  [[ 2.60293009e-02  3.96269152e-03  3.76125107e-04 ... -1.78626172e-03
#     2.70523835e-03 -2.03545477e-03]
#   [ 3.96269152e-03  2.94954165e-02  1.07738992e-02 ... -5.09831666e-03
#     4.71919893e-03  4.33969973e-03]
#   [ 3.76125107e-04  1.07738992e-02  4.21367798e-02 ... -5.07668996e-03
#    -3.46291162e-03  5.21974129e-03]
#   ...
#   [-1.78626172e-03 -5.09831666e-03 -5.07668996e-03 ...  4.16710966e-02
#    -1.36220053e-02 -6.03420156e-04]
#   [ 2.70523835e-03  4.71919893e-03 -3.46291162e-03 ... -1.36220053e-02
#     5.75839611e-02 -3.38178684e-03]
#   [-2.03545477e-03  4.33969973e-03  5.21974129e-03 ... -6.03420156e-04
#    -3.38178684e-03  2.99411761e-02]]

#  [[ 2.75197849e-02 -3.49524455e-03  1.93545784e-03 ... -3.67777264e-03
#    -3.43049520e-05 -3.33155512e-03]
#   [-3.49524455e-03  4.69184508e-02 -2.22180030e-03 ... -1.30211582e-02
#     1.74943163e-04  4.95282976e-03]
#   [ 1.93545784e-03 -2.22180030e-03  3.95164537e-02 ...  7.41624883e-03
#    -6.51146210e-03  5.36897138e-03]
#   ...
#   [-3.67777264e-03 -1.30211582e-02  7.41624883e-03 ...  3.86088712e-02
#    -2.14508323e-03 -2.61032899e-03]
#   [-3.43049520e-05  1.74943163e-04 -6.51146210e-03 ... -2.14508323e-03
#     3.60817007e-02 -6.42433947e-03]
#   [-3.33155512e-03  4.95282976e-03  5.36897138e-03 ... -2.61032899e-03
#    -6.42433947e-03  4.74365891e-02]]]
# Weights:
#  [0.35 0.32 0.33]
# Memebership:
#  [[0. 1. 0.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [0. 0. 1.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [0. 0. 1.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [0. 0. 1.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [0. 1. 0.]
#  [0. 1. 0.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [0. 0. 1.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [0. 1. 0.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [0. 1. 0.]
#  [0. 1. 0.]
#  [0. 1. 0.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [0. 0. 1.]
#  [0. 0. 1.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [1. 0. 0.]
#  [0. 0. 1.]
#  [1. 0. 0.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [0. 0. 1.]
#  [0. 0. 1.]
#  [1. 0. 0.]
#  [0. 1. 0.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [0. 0. 1.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [0. 0. 1.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [0. 0. 1.]
#  [1. 0. 0.]
#  [0. 1. 0.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [0. 0. 1.]
#  [0. 0. 1.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [0. 0. 1.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [0. 1. 0.]
#  [0. 1. 0.]
#  [0. 1. 0.]
#  [0. 1. 0.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [0. 0. 1.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [0. 1. 0.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [0. 0. 1.]
#  [0. 0. 1.]
#  [0. 0. 1.]
#  [0. 0. 1.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [1. 0. 0.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [1. 0. 0.]
#  [0. 0. 1.]
#  [1. 0. 0.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [0. 0. 1.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [0. 0. 1.]
#  [1. 0. 0.]
#  [0. 1. 0.]
#  [0. 0. 1.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [0. 1. 0.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [1. 0. 0.]
#  [1. 0. 0.]]
# Likelihood:
#  2625.7689252014434